        var percentColors = [
        { pct: 0.0, color: { r: 0x00, g: 0x00, b: 0xff } },
        { pct: 0.5, color: { r: 0xaa, g: 0xaa, b: 0xaa } },
        { pct: 1.0, color: { r: 0xff, g: 0, b: 0x00 } } ];

        var getColorForPercentage = function(pct) {
            for (var i = 1; i < percentColors.length - 1; i++) {
                if (pct < percentColors[i].pct) {
                    break;
                }
            }
            var lower = percentColors[i - 1];
            var upper = percentColors[i];
            var range = upper.pct - lower.pct;
            var rangePct = (pct - lower.pct) / range;
            var pctLower = 1 - rangePct;
            var pctUpper = rangePct;
            var color = {
                r: Math.floor(lower.color.r * pctLower + upper.color.r * pctUpper),
                g: Math.floor(lower.color.g * pctLower + upper.color.g * pctUpper),
                b: Math.floor(lower.color.b * pctLower + upper.color.b * pctUpper)
            };
            return 'rgb(' + [color.r, color.g, color.b].join(',') + ')';
    // or output as hex if preferred
}  


var colordict = {'0': 'rgba(31,119,180,1.0)',
'1': 'rgba(174,199,232,1.0)',
'2': 'rgba(255,127,14,1.0)',
'3': 'rgba(255,187,120,1.0)',
'4': 'rgba(44,160,44,1.0)',
'5': 'rgba(152,223,138,1.0)',
'6': 'rgba(214,39,40,1.0)',
'7': 'rgba(255,152,150,1.0)',
'8': 'rgba(148,103,189,1.0)',
'9': 'rgba(197,176,213,1.0)',
'10': 'rgba(140,86,75,1.0)',
'11': 'rgba(196,156,148,1.0)',
'12': 'rgba(227,119,194,1.0)',
'13': 'rgba(247,182,210,1.0)',
'14': 'rgba(127,127,127,1.0)',
'15': 'rgba(199,199,199,1.0)',
'16': 'rgba(188,189,34,1.0)',
'17': 'rgba(219,219,141,1.0)'}



var paplancolors = [];
var plancolor = []
function colorplan(feature) {

            plancolor.push(parseInt(feature.properties["T16SENR"])/(parseInt(feature.properties["T16SEND"]) + parseInt(feature.properties["T16SENR"])));
            //feature.properties["color"] = 0    
            return {
                //pane: 'pane_PA_VTD_PLANS_0',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.75, 
                fill: true,
                fillOpacity: 1,
                fillColor: getColorForPercentage(parseInt(feature.properties["T16SENR"])/(parseInt(feature.properties["T16SEND"]) + parseInt(feature.properties["T16SENR"]))),
                //colordict[String(feature.properties["assn"])],
            };
        }



        const pamakemap = (bindto,varname) =>  {
            plancolor = [];
            var map = new L.map(bindto, {
                maxZoom:12.6, minZoom:5.6, zoomSnap:.1, attributionControl: false,
            });

            var layer =  L.geoJson(varname, {
                style: colorplan,
            }).addTo(map);

            
             map.fitBounds(layer.getBounds());
           map.setZoom(6.6)
            paplancolors.push(plancolor.slice(0).sort())
            return layer;
        }



        [['pamap0', vtds_0], 
['pamap1', vtds_1], 
['pamap2', vtds_2], 
['pamap3', vtds_3], 
['pamap4', vtds_4], 
['pamap5', vtds_5], 
['pamap6', vtds_6], 
['pamap7', vtds_7], 
['pamap8', vtds_8], 
['pamap9', vtds_9], 
['pamap10', vtds_10], 
['pamap11', vtds_11], 
['pamap12', vtds_12], 
['pamap13', vtds_13], 
['pamap14', vtds_14], 
['pamap15', vtds_15], 
['pamap16', vtds_16], 
['pamap17', vtds_17], 
['pamap18', vtds_18], 
['pamap19', vtds_19], 
['pamap20', vtds_20], 
['pamap21', vtds_21], 
['pamap22', vtds_22], 
['pamap23', vtds_23], 
['pamap24', vtds_24]].forEach(x => pamakemap(x[0],x[1]))


const sv_0 =  [[1, 0.30159128342748853], [2, 0.3306841924796967], [3, 0.3414973396923213], [4, 0.3798712973009437], [5, 0.4134654840838161], [6, 0.4441758492110889], [7, 0.46782175983306984], [8, 0.4766640241505745], [9, 0.4942195632630115], [10, 0.5097495543578583], [11, 0.5366221799809181], [12, 0.5437641810920292], [13, 0.5578886334389306], [14, 0.5867487604658959], [15, 0.6217160788651047], [16, 0.6584784310817687], [17, 0.6693540851420294], [18, 0.6984303744021079]]
const scores_0 = [0.14, 0.996];


const sv_1 =  [[1, 0.2861252565011404], [2, 0.3234206401057659], [3, 0.35292299541813565], [4, 0.3568001067822605], [5, 0.41496678053322933], [6, 0.4480632827208373], [7, 0.4816550367681677], [8, 0.4968330930948469], [9, 0.4977900325415116], [10, 0.5079390983207229], [11, 0.5183037518397773], [12, 0.5197626101432882], [13, 0.5685691942995753], [14, 0.5852331865841592], [15, 0.643078006396151], [16, 0.6470543431213684], [17, 0.6765501178763935], [18, 0.713392609620159]]
const scores_1 = [0.168, 0.996];


const sv_2 =  [[1, 0.3011728746202201], [2, 0.32240584055805194], [3, 0.3473330424318422], [4, 0.368104054263165], [5, 0.4205410615501021], [6, 0.45329734923845394], [7, 0.47124347818875384], [8, 0.4891453170248124], [9, 0.4919350627477436], [10, 0.5093827520841477], [11, 0.5270609429452753], [12, 0.5396812292177808], [13, 0.5578242959588657], [14, 0.579448488356321], [15, 0.6353508738239912], [16, 0.6525572126274066], [17, 0.677659079009122], [18, 0.6972034720018571]]
const scores_2 = [0.216, 0.995];


const sv_3 =  [[1, 0.3286652440136083], [2, 0.33181987146895675], [3, 0.3619080630058903], [4, 0.3815468467657426], [5, 0.39530321635709875], [6, 0.40814567625667464], [7, 0.4309725076107084], [8, 0.4940238970387619], [9, 0.5153616039804243], [10, 0.518109589159041], [11, 0.5264043004928664], [12, 0.5690823609520408], [13, 0.5919054272174782], [14, 0.6062639197739592], [15, 0.6186152110759393], [16, 0.6380793202071855], [17, 0.6682854204931576], [18, 0.671388640847625]]
const scores_3 = [0.221, 0.994];


const sv_4 =  [[1, 0.2936545940669076], [2, 0.3356203679875794], [3, 0.3544330642552996], [4, 0.3626024490754504], [5, 0.40754973665606836], [6, 0.43383584345128584], [7, 0.44509411619908584], [8, 0.4721042566459393], [9, 0.501226454649591], [10, 0.5078004840305903], [11, 0.5392519526625481], [12, 0.5792772426466721], [13, 0.5808272729693087], [14, 0.5965415634033969], [15, 0.6373953546847873], [16, 0.6454216490507232], [17, 0.6643492390113315], [18, 0.6949204910690612]]
const scores_4 = [0.225, 0.992];


const sv_5 =  [[1, 0.29667152519507706], [2, 0.33197669596768614], [3, 0.33370948977165454], [4, 0.3871029643472182], [5, 0.39757618881534645], [6, 0.4440705986733399], [7, 0.48832222606932757], [8, 0.4887729738670494], [9, 0.495356118288711], [10, 0.5045946358861065], [11, 0.537683463944155], [12, 0.5630680511080366], [13, 0.5679494476385004], [14, 0.6024321113015412], [15, 0.6128982216106367], [16, 0.6662872842055948], [17, 0.6678573107201601], [18, 0.7012103811590134]]
const scores_5 = [0.227, 0.99];


const sv_6 =  [[1, 0.2923781474595702], [2, 0.330079352793665], [3, 0.3340203748748071], [4, 0.39136608246801147], [5, 0.39681443485688156], [6, 0.4442532603072053], [7, 0.48868618680310155], [8, 0.49231760713408196], [9, 0.4949744944541253], [10, 0.505218005315565], [11, 0.5375446688017871], [12, 0.563251553600966], [13, 0.5694476998868654], [14, 0.6033580771018806], [15, 0.6084766169115784], [16, 0.6661921118205988], [17, 0.6697454112013501], [18, 0.7016166453288176]]
const scores_6 = [0.23, 0.989];


const sv_7 =  [[1, 0.2601359948389164], [2, 0.33222099027944235], [3, 0.33584540321243445], [4, 0.371314573296142], [5, 0.4144102619662922], [6, 0.4606553890470559], [7, 0.4757408838014397], [8, 0.4855063805405417], [9, 0.4964311709326106], [10, 0.5226580716713862], [11, 0.52696347621222], [12, 0.5532612233141756], [13, 0.5571936486887785], [14, 0.5855814865839852], [15, 0.6287595673276332], [16, 0.6639787992789874], [17, 0.6676960856849175], [18, 0.7150881901633003]]
const scores_7 = [0.232, 0.988];


const sv_8 =  [[1, 0.26974725141923306], [2, 0.3375576584087192], [3, 0.3691313285190586], [4, 0.38267666348545293], [5, 0.41592107984397697], [6, 0.41781640398500586], [7, 0.43560871902609133], [8, 0.4392574792145566], [9, 0.5003427137389318], [10, 0.5119777325710171], [11, 0.5696238326091283], [12, 0.5895813790645641], [13, 0.5954773751548201], [14, 0.5983977857202338], [15, 0.6176004410566736], [16, 0.6316425305498783], [17, 0.6641062559482147], [18, 0.6926599379931112]]
const scores_8 = [0.238, 0.987];


const sv_9 =  [[1, 0.2322321855471043], [2, 0.3367392598426879], [3, 0.3605755787495561], [4, 0.4046566693567834], [5, 0.40477700912427067], [6, 0.42724819339938164], [7, 0.4809322971638323], [8, 0.4905250275360407], [9, 0.49283347671698835], [10, 0.5177167249284003], [11, 0.5521983558317882], [12, 0.5555257705467436], [13, 0.5908031068549806], [14, 0.5952516172680598], [15, 0.5958268637011581], [16, 0.639442696078331], [17, 0.6630924287350225], [18, 0.7101417978048128]]
const scores_9 = [0.262, 0.982];


const sv_10 =  [[1, 0.2415902342124866], [2, 0.33047142325198176], [3, 0.35270127375220905], [4, 0.36839126379154596], [5, 0.4084798619807567], [6, 0.4668134402688935], [7, 0.47633290908324366], [8, 0.49742372301309873], [9, 0.5017138580590023], [10, 0.5017382048397002], [11, 0.5367497544717387], [12, 0.5650465831890925], [13, 0.5729909889962232], [14, 0.5908951516054548], [15, 0.6316741192207221], [16, 0.647228836424405], [17, 0.669590539386529], [18, 0.6921453010977776]]
const scores_10 = [0.271, 0.979];


const sv_11 =  [[1, 0.25700317889559154], [2, 0.3365661328368288], [3, 0.34848898030326614], [4, 0.37497068301485215], [5, 0.40320951722856657], [6, 0.4139449583333922], [7, 0.48951435465237003], [8, 0.4949212279532655], [9, 0.5162081182275846], [10, 0.5347574356986566], [11, 0.5535022581155535], [12, 0.5618199209915358], [13, 0.5860986374627825], [14, 0.5966452072128487], [15, 0.6249851817641243], [16, 0.6515186149021053], [17, 0.6634311564281747], [18, 0.7035791655359998]]
const scores_11 = [0.276, 0.979];


const sv_12 =  [[1, 0.2535347557870928], [2, 0.33688014870847444], [3, 0.3433020123919169], [4, 0.3789153432800228], [5, 0.40865861259164765], [6, 0.41986028782436685], [7, 0.49441687691805347], [8, 0.49448079263473527], [9, 0.5151486398647541], [10, 0.5295124527401469], [11, 0.5491881962824596], [12, 0.5687523811040953], [13, 0.5889777230418247], [14, 0.5924495752347056], [15, 0.6208819997533184], [16, 0.6572870419835855], [17, 0.663337628217903], [18, 0.7012045028902698]]
const scores_12 = [0.282, 0.977];


const sv_13 =  [[1, 0.21070304912833726], [2, 0.3310979649168784], [3, 0.3580410171391444], [4, 0.38090775923449505], [5, 0.41484816426977467], [6, 0.4659452202901617], [7, 0.4899305098537903], [8, 0.49451781119103727], [9, 0.4965585294752404], [10, 0.505648940412184], [11, 0.5413461435935303], [12, 0.5705255554388018], [13, 0.5714521959447356], [14, 0.5850867446250096], [15, 0.6217026900330409], [16, 0.6421395724274868], [17, 0.6684708453835815], [18, 0.6943353189300281]]
const scores_13 = [0.285, 0.974];


const sv_14 =  [[1, 0.2319966835643852], [2, 0.33118325157580797], [3, 0.33711131689482043], [4, 0.387315616024544], [5, 0.4060719075660566], [6, 0.43709274260653275], [7, 0.4501113368759294], [8, 0.5085232069409448], [9, 0.5306022980429006], [10, 0.542802394657832], [11, 0.547003483197985], [12, 0.5633322704550432], [13, 0.5739184279947692], [14, 0.5933635250896843], [15, 0.6127009136248402], [16, 0.662847243340688], [17, 0.6660260627862278], [18, 0.6720708438162978]]
const scores_14 = [0.292, 0.972];


const sv_15 =  [[1, 0.21441573385128276], [2, 0.32124880360367836], [3, 0.35820910813412377], [4, 0.4054264670482711], [5, 0.41092329860256305], [6, 0.4610532803291375], [7, 0.48532713864420196], [8, 0.5013393375935827], [9, 0.5117977434475836], [10, 0.5384137063370156], [11, 0.5440703924432695], [12, 0.5616386305663771], [13, 0.586298895109874], [14, 0.5891023647825968], [15, 0.5946189549584112], [16, 0.6417937509583441], [17, 0.6713248458805106], [18, 0.7047790520714905]]
const scores_15 = [0.295, 0.969];


const sv_16 =  [[1, 0.22077215531229621], [2, 0.31753145135593186], [3, 0.35975080151132954], [4, 0.40371839166909784], [5, 0.40897579127817274], [6, 0.4598170917270056], [7, 0.4701513251584497], [8, 0.49946627926857085], [9, 0.5164604510514166], [10, 0.5443942937022959], [11, 0.5584401585363652], [12, 0.5624973933255559], [13, 0.5841590301894624], [14, 0.5909785126770342], [15, 0.5960431235434607], [16, 0.641907110622929], [17, 0.6707756693258851], [18, 0.7059715019153445]]
const scores_16 = [0.297, 0.969];


const sv_17 =  [[1, 0.22115480272256732], [2, 0.3202720620575789], [3, 0.35638834887227216], [4, 0.40301057248048416], [5, 0.40915434492124053], [6, 0.4625572794819314], [7, 0.47093830360308514], [8, 0.500269798492509], [9, 0.5167312367521171], [10, 0.5432067630307005], [11, 0.5552814061771844], [12, 0.5631953152857667], [13, 0.5848951286966655], [14, 0.5908561039144247], [15, 0.5959042628366393], [16, 0.6434937528190242], [17, 0.6699944403493376], [18, 0.7045070468233623]]
const scores_17 = [0.3, 0.969];


const sv_18 =  [[1, 0.21960644379767386], [2, 0.3219894715930383], [3, 0.35735738821989854], [4, 0.3998899185124429], [5, 0.40926989180655154], [6, 0.46163238688310654], [7, 0.4726667228897407], [8, 0.501427055960834], [9, 0.5152464870323885], [10, 0.5453790031426975], [11, 0.553889364938726], [12, 0.5627262461086976], [13, 0.5841995017623252], [14, 0.5906829432891036], [15, 0.5961793844268501], [16, 0.6419111793125827], [17, 0.669754449357783], [18, 0.7061720860457683]]
const scores_18 = [0.309, 0.968];


const sv_19 =  [[1, 0.12993473660924676], [2, 0.3474454413681051], [3, 0.3717206164790586], [4, 0.3907907815659159], [5, 0.4017242522998878], [6, 0.4107103858869025], [7, 0.49753148691004057], [8, 0.5045888555927334], [9, 0.5261824840834606], [10, 0.5499868398485461], [11, 0.5681532798473685], [12, 0.5710627285467148], [13, 0.5926939684853245], [14, 0.5991845469615356], [15, 0.6104407707629497], [16, 0.62842806523799], [17, 0.6528525958168906], [18, 0.6998516815049542]]
const scores_19 = [0.338, 0.956];


const sv_20 =  [[1, 0.12792413175598488], [2, 0.28508933358138716], [3, 0.3577156305363543], [4, 0.38948863275551765], [5, 0.4191060116728224], [6, 0.4730790220088104], [7, 0.5003222442466537], [8, 0.5034932677819914], [9, 0.5405107483916126], [10, 0.5519462242507716], [11, 0.5692500051964349], [12, 0.5811249227195461], [13, 0.585856681465664], [14, 0.5988819220065211], [15, 0.6109700326063559], [16, 0.6326983161663896], [17, 0.6548961844974339], [18, 0.6979946438799838]]
const scores_20 = [0.34, 0.937];


const sv_21 =  [[1, 0.1587017369806924], [2, 0.24142938680725573], [3, 0.3395615181390574], [4, 0.4249435868481117], [5, 0.428779589964327], [6, 0.4967999132968137], [7, 0.5038747003971644], [8, 0.5049744061552659], [9, 0.5157329687822105], [10, 0.5208199839309755], [11, 0.5451860637664765], [12, 0.5600045024751006], [13, 0.5809217880529427], [14, 0.60563604731801], [15, 0.6324080159020897], [16, 0.661154428669851], [17, 0.6663938696770706], [18, 0.6709877242476514]]
const scores_21 = [0.353, 0.935];


const sv_22 =  [[1, 0.12061692991050221], [2, 0.26414050405953926], [3, 0.3678177881764606], [4, 0.3825564340606512], [5, 0.3881472945972342], [6, 0.48262049534600093], [7, 0.5058619558670414], [8, 0.5120104981199611], [9, 0.5343949924952474], [10, 0.5419872713293772], [11, 0.5612026200970874], [12, 0.5860141935852605], [13, 0.6146925340759746], [14, 0.6200957147492598], [15, 0.6223326508583724], [16, 0.633740835175581], [17, 0.6517565243533021], [18, 0.6628388890459858]]
const scores_22 = [0.36, 0.927];


const sv_23 =  [[1, 0.12369206070904948], [2, 0.2630076619340238], [3, 0.36579248891440486], [4, 0.3846546395247481], [5, 0.39086002544183207], [6, 0.4787728524312518], [7, 0.5085030021909793], [8, 0.5118151181563237], [9, 0.5367459326041545], [10, 0.5413914290322694], [11, 0.5617647052864247], [12, 0.5865326434277727], [13, 0.6110019396795985], [14, 0.6201324234351515], [15, 0.627429317314415], [16, 0.6344126520889077], [17, 0.6520669604700908], [18, 0.6620412576633152]]
const scores_23 = [0.36, 0.927];


const sv_24 =  [[1, 0.12267731980779562], [2, 0.2572699520552928], [3, 0.3714930605194997], [4, 0.3829927422814603], [5, 0.3892201398330237], [6, 0.48515065687408854], [7, 0.5084270180244724], [8, 0.5105739225818212], [9, 0.5350456070142185], [10, 0.5433018734783139], [11, 0.5629941819430716], [12, 0.587495891590812], [13, 0.6151246525137092], [14, 0.6196099191815111], [15, 0.6236724211765792], [16, 0.6309760410992498], [17, 0.6538620581084265], [18, 0.6620857441325667]]
const scores_24 = [0.36, 0.926];







        const w = 300;


        const h = 300;

        const makeplot = (name, ds, scores) => {
            var svg = d3.select("#pamap_"+String(name)+"_plot")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

            svg.append("text")
            .attr("x",20)
            .attr("y",25)
            .text("Polsby-Popper: " + String(scores[0]))

            svg.append("text")
            .attr("x",20)
            .attr("y",50)
            .text("Partisan Symmetry: " + String(scores[1]))
            


            svg.append("line")
            .attr("x1",0)
            .attr("y1",0)
            .attr("x2",0)
            .attr("y2",h)
            .style("stroke-width",3)
            .style("stroke","#999999");
            svg.append("line")
            .attr("x1",0)
            .attr("y1",h)
            .attr("x2",w)
            .attr("y2",h)
            .style("stroke-width",3)
            .style("stroke","#999999");

            svg.append("line")
            .attr("x1", 0)
            .attr("x2", 5)
            .attr("y1", .75*h)
            .attr("y2", .75*h )
            .style("stroke","#242424")
            .style("stroke-width", 3);


            svg.append("line")
            .attr("x1", 0)
            .attr("x2", 5)
            .attr("y1", .5*h)
            .attr("y2", .5*h )
            .style("stroke","#242424")
            .style("stroke-width", 3);

            svg.append("text")
            .text("0.5")
            .attr("x", 10)
            .attr("y", .5*h+5)
            .style("font-size", ".7em");

            svg.append("line")
            .attr("x1", 0)
            .attr("x2", 5)
            .attr("y1", .25*h)
            .attr("y2", .25*h )
            .style("stroke","#242424")
            .style("stroke-width", 3);


            for (var i=1; i<=18; i+=1){
            svg.append("line")
            .attr("x1", i*w/20)
            .attr("x2", i*w/20)
            .attr("y1", h)
            .attr("y2", h-5 )
            .style("stroke","#242424")
            .style("stroke-width", 3);

}


            var circs = svg.selectAll("circle")
            .data(ds)
            .enter();

            circs.append("circle")

            .attr("cx", function(d) {
                return d[0]*w/20;
            })
            .attr("cy", function(d) {
                return h-(d[1]*h);
            })
            .attr("r", 6)
            .style("fill",function(d) {  return getColorForPercentage( paplancolors[parseInt(name)][d[0]-1] )})
            

            circs.append("circle")
            .attr("cx" ,function(d) {return w - ((d[0]+1)*w/20) }  )
            .attr("cy", function(d) { return d[1]*h })
            .attr("r",2)
            .style("fill", "#242424");


        }


        [['0', sv_0, scores_0], 
['1', sv_1, scores_1], 
['2', sv_2, scores_2], 
['3', sv_3, scores_3], 
['4', sv_4, scores_4], 
['5', sv_5, scores_5], 
['6', sv_6, scores_6], 
['7', sv_7, scores_7], 
['8', sv_8, scores_8], 
['9', sv_9, scores_9], 
['10', sv_10, scores_10], 
['11', sv_11, scores_11], 
['12', sv_12, scores_12], 
['13', sv_13, scores_13], 
['14', sv_14, scores_14], 
['15', sv_15, scores_15], 
['16', sv_16, scores_16], 
['17', sv_17, scores_17], 
['18', sv_18, scores_18], 
['19', sv_19, scores_19], 
['20', sv_20, scores_20], 
['21', sv_21, scores_21], 
['22', sv_22, scores_22], 
['23', sv_23, scores_23], 
['24', sv_24, scores_24]].forEach(x => makeplot(x[0],x[1],x[2])) 
